/**
* 로그인 화면
* pre - 2022.09.09
* modify - 2022.09.24
* dev : 이규호, 최양원
* copyright : 이규호, 최양원
*/
<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="/images/penguin_icon.png" type="image/x-icon" rel="shortcut icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css"
        integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap-theme.min.css"
        integrity="sha384-6pzBo3FDv/PJ8r2KRkGHifhEocL+1X2rVCTTkUfGk7/0pbek5mMa1upzvWbrUbOZ" crossorigin="anonymous">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.9.2/jquery.contextMenu.min.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css" />
    <link rel="stylesheet" type="text/css" href="/css/intro.css" />

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js"
        integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd"
        crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/luxon@3.0.3/build/global/luxon.min.js"
        integrity="sha256-RH4TKnKcKyde0s2jc5BW3pXZl/5annY3fcZI9VrV5WQ=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.3/dist/js/tabulator.min.js"></script>

    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5core/master/dist/ax5core.min.js"></script>
    <script type="text/javascript"
        src="https://cdn.rawgit.com/ax5ui/ax5ui-calendar/master/dist/ax5calendar.min.js"></script>
    <script type="text/javascript"
        src="https://cdn.rawgit.com/ax5ui/ax5ui-formatter/master/dist/ax5formatter.min.js"></script>
    <script type="text/javascript"
        src="https://cdn.rawgit.com/ax5ui/ax5ui-picker/master/dist/ax5picker.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.9.2/jquery.contextMenu.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.9.2/jquery.ui.position.js"></script>
    <!-- <script type="text/javascript" src="/js/common.js"></script> -->

    <script src="/js/default.js"></script>
    <script src="/js/intro.js"></script>

    <title>qenguin coder</title>
</head>

<body>
    <div class="container">
        <div class="login-contents">
            <div class="sec-contents">
                <p class="text-login">로그인</p>
            </div>
            <div class="login-inner-contents">
                <p>계정 정보를 입력한 후에<br>접속하실 수 있습니다.</p>
            </div>
            <div class="login-module">
                <form id="login_form" name="login_form" method="post">
                    <div class="row">
                        <label for="login_id" class="login-label">ID</label><input type="text" id="login_id"
                            name="login_id" required placeholder="아이디를 입력하세요." value="" />
                    </div>
                    <div class="row" style="padding: 3px;"></div>
                    <div class="row">
                        <label for="login_pw">PASSWORD</label><input type="password" id="login_pw" name="login_pw"
                            required placeholder="패스워드를 입력하세요." value="" />
                    </div>
                </form>
            </div>
            <div class="login-btn">
                <button class="btn btn-info" id="intro_regist_btn" type="submit" data-toggle="modal"
                    data-target="#registModal"><span class="glyphicon glyphicon-user"></span>회원가입</button>
                <button class="btn btn-primary" id="intro_login_btn" type="submit"><span
                        class="glyphicon glyphicon-ok"></span> 로그인</button>
            </div>
            <div id="saveIdDiv" class="saveIdDiv">
                <input type="checkbox" id="saveId" class="saveId"><label for="saveId">아이디 저장</label>
            </div>
        </div>
    </div>
    <!-- Regist Modal -->
    <div class="modal fade" id="registModal" tabindex="-1" role="dialog" aria-labelledby="registModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="registModalLabel">회원가입</h4>
                </div>
                <div class="modal-body">
                    <form id="regist-form" name="regist-form">
                        <div id="regist-div" class="form-row">
                            <div id="insert-id-form" class="form-group">
                                <label for="insert_Id">Username</label>
                                <div class="row" style="padding: 1px;"></div>
                                <input class="form-control" id="insert_Id" type="text" required
                                    placeholder="아이디를 입력하세요." size="15" value="">
                            </div>
                            <div class="row" style="padding: 3px;"></div>
                            <div id="insert-email-form" class="form-group">
                                <label for="insert_Email">Email</label>
                                <div class="row" style="padding: 1px;"></div>
                                <div class="inline-form">
                                    <input class="form-control" id="insert_Email" type="text" required
                                        placeholder="Email" value=""><label for="select_domain"
                                        class="at">@</label><input type="text" class="form-control" id="input-domain"
                                        placeholder="example.com">
                                    <select class="form-control" id="select_domain">
                                        <option value="1" selected>직접입력</option>
                                        <option value="naver.com">naver.com</option>
                                        <option value="hanmail.net">hanmail.net</option>
                                        <option value="hotmail.com">hotmail.com</option>
                                        <option value="nate.com">nate.com</option>
                                        <option value="yahoo.co.kr">yahoo.co.kr</option>
                                        <option value="empas.com">empas.com</option>
                                        <option value="dreamwiz.com">dreamwiz.com</option>
                                        <option value="freechal.com">freechal.com</option>
                                        <option value="lycos.co.kr">lycos.co.kr</option>
                                        <option value="korea.com">korea.com</option>
                                        <option value="gmail.com">gmail.com</option>
                                        <option value="hanmir.com">hanmir.com</option>
                                        <option value="paran.com">paran.com</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row" style="padding: 3px;"></div>
                            <div id="insert-pw-form" class="form-group">
                                <label for="insert_Pw">Password</label>
                                <div class="row" style="padding: 1px;"></div>
                                <input class="form-control" id="insert_Pw" type="password" required
                                    placeholder="비밀번호를 입력하세요." onchange="fnCheckPw()">
                            </div>
                            <div class="row" style="padding: 3px;"></div>
                            <div id="insert-pw-confirm-form" class="form-group">
                                <label for="insert_Pw_confirm">Confirm Password</label>
                                <div class="row" style="padding: 1px;"></div>
                                <input class="form-control" id="insert_Pw_confirm" type="password" required
                                    placeholder="비밀번호를 다시 입력하세요." onchange="fnCheckPw()">
                                <label class="pwConfirmError" style="visibility: hidden;">비밀번호가 틀립니다!</label>
                            </div>
                            <div id="regist_btn" class="form-group">
                                <button class="btn btn-primary" id="try_regist_btn" onclick="fnTryRegist()"><span
                                        class="glyphicon glyphicon-ok"></span>회원가입
                                </button>
                            </div>
                        </div>
                    </form>
                    <button class="btn btn-info" id="checkId" onclick="fnCheckId()">중복확인</button>
                </div>
            </div>
        </div>
        <script>
            // email 도메인 선택시 input 변경 쿼리
            $("#select_domain").change(function () {
                $("#select_domain option:selected").each(function () {
                    if ($(this).val() == '1') {
                        $("#input-domain").val('');
                        $("#input-domain").attr("disabled", false);
                    } else {
                        $("#input-domain").val($(this).text());
                        $("#input-domain").attr("disabled", true);
                    }
                });
            });

            let userId = "";
            let userEmail = "";
            let inputDomain = "";
            let userPw = "";
            let userPw2 = "";
            let fnCheckId_result = 1; // 아이디 중복 체크 결과를 담을 변수
            let fnCheckPw_result = 1; // 비밀번호 일치 확인 결과를 담을 변수

            // 회원가입 쿼리
            function fnCheckId() {
                userId = $('#insert_Id').val();

                if (localStorage.getItem(userId) == null) {
                    alert("사용 가능한 ID 입니다.");
                    fnCheckId_result = 0;
                } else {
                    alert("사용중인 ID 입니다.");
                    fnCheckId_result = 1;
                }
            }

            // 비밀번호 확인 query
            function fnCheckPw() {
                var pw1 = $('#insert_Pw').val();
                var pw2 = $('#insert_Pw_confirm').val();
                var pwsc = ["!", "@", "#", "%", "^", "?"];
                var pw_check_sc = 0;
                var num = pw1.search(/[0-9]/g);
                var eng = pw1.search(/[a-z]/ig);
                var spe = pw1.search(/[!@#%^?]/gi);

                if (pw1.length < 6 || pw1.length > 15) {
                    alert("비밀번호는 6글자 이상, 15글자 이하로 입력해주세요.");
                    document.getElementById('insert_Pw').value = '';
                    return false;
                }
                if (pw1.search(/\s/) != -1) {
                    alert("비밀번호는 공백 없이 입력해주세요.");
                    return false;
                }
                for (var i = 0; i < pwsc.length; i++) {
                    if (pw1.indexOf(pwsc[i]) != 0 - 1) {
                        pw_check_sc = 1;
                    }
                }
                if (pw_check_sc == 0) {
                    alert("!,@,#,%,^,?의 특수문자가 들어가 있지 않습니다.");
                    document.getElementById('insert_Pw').value = '';
                    return false;
                }
                if (num < 0 || eng < 0 || spe < 0) {
                    alert("영문, 숫자, 특수문자를 혼합하여 입력해주세요.");
                    return false;
                }
                if ($('#insert_Pw').val() != "" && $('#insert_Pw_confirm').val() != "") {
                    if ($('#insert_Pw').val() == $('#insert_Pw_confirm').val()) {
                        $('.pwConfirmError').css('visibility', 'hidden');
                        fnCheckPw_result = 0;
                    } else {
                        $('.pwConfirmError').css('visibility', 'visible');
                        fnCheckPw_result = 1;
                    }
                }
            }

            function fnTryRegist() {
                userId = $('#insert_Id').val();
                userEmail = $('#insert_Email').val() + "@" + $("#input-domain").val();
                emailDomain = $('#input-domain').val();
                userPw = $('#insert_Pw').val();
                userPw2 = $('#insert_Pw_confirm').val();

                if (userId == "") {
                    alert("아이디를 입력해주세요.");
                    return false;
                }
                if (userEmail == "", emailDomain == "") {
                    alert("이메일을 입력해주세요.");
                    return false;
                }
                if (userPw == "", userPw2 == "") {
                    alert("비밀번호를 입력해주세요.");
                    return false;
                }
                if (fnCheckId_result == 1) {
                    alert("아이디 중복확인을 확인해주세요.");
                    return false;
                } else if (fnCheckPw_result == 1) {
                    alert("비밀번호를 확인해주세요.");
                    return false;
                }
                if (fnCheckId_result == 0, fnCheckPw_result == 0) {
                    var infoArr = { email: userEmail, password: userPw2 }
                    console.log("start to submit user info...");
                    localStorage.setItem(userId, JSON.stringify(infoArr));
                    alert("회원가입이 완료되었습니다.");
                }
            }
        </script>
    </div>
    <!-- login fail Modal -->
    <div class="modal fade" id="loginFailModal" tabindex="-1" role="dialog" aria-labelledby="registModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="registModalLabel" style="color: red;">로그인 실패</h4>
                </div>
                <div class="modal-body">
                    <label>로그인에 실패하였습니다.<br>아이디 또는 패스워드를 확인해주세요.</label>
                </div>
            </div>
        </div>
    </div>
</body>

</html>